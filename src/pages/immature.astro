---
import leftHandBottom from '@/assets/hand-sex-bottom.png';
import rightHand from '@/assets/hand-sex-middle.png';
import leftHandTop from '@/assets/hand-sex-top.png';
import ResizerContainer from '@/components/resizer-container.astro';
import SvgSprite from '@/components/SvgSprite.astro';
import HomeLayout from '@/layouts/home.astro';
import { Image } from 'astro:assets';
---

<HomeLayout>
	<div>
		<a
			href="/"
			class="z-10 mr-4 rounded-full bg-gray-900 p-2 font-semibold text-white hover:bg-gray-800"
		>
			<SvgSprite name="mdi:chevron-left" class="h-6 w-6" />
		</a>
		<a class="capitalize after:pl-2 after:content-['/']" href="/">home</a>
	</div>
	<div class="select-none p-24">
		<h1 class="mx-auto max-w-4xl text-center text-white">Responsive design can be so immature.</h1>
		<ResizerContainer class="relative mx-auto h-screen min-h-screen w-full">
			<div class="relative h-[60vh] min-h-[60vh] w-full overflow-hidden">
				<div id="bottom" class="absolute left-0 top-1/2 w-full">
					<Image
						src={leftHandBottom}
						alt="outer stacked image of a left hand"
						class="absolute left-0 top-1/2 -mt-[116px] h-[232px] min-w-[511px]"
					/>
				</div>
				<div id="middle" class="absolute right-0 top-[57%] w-full">
					<Image
						src={rightHand}
						alt="image of a right hand"
						class="absolute right-0 top-1/2 -mt-[95px] h-[190px] min-w-[496px]"
					/>
				</div>
				<div id="top" class="absolute left-0 top-1/2 w-full">
					<Image
						src={leftHandTop}
						alt="inner stacked image of a left hand"
						class="absolute -left-[1px] top-1/2 -mt-[27px] h-[136px] min-w-[317px]"
					/>
				</div>

				<div class="absolute bottom-0 right-0 p-2 text-white" id="resize">Resize me &gt;</div>
			</div>
		</ResizerContainer>
	</div>
</HomeLayout>

<script>
	document.addEventListener('astro:page-load', () => {
		const bottom: HTMLElement | null = document.getElementById('bottom');
		const top: HTMLElement | null = document.getElementById('top');
		const body: HTMLElement | null = document.body;

		const resizer = document.getElementById('resize-me');

		const resizeObserver = new ResizeObserver((entries) => {
			for (const entry of entries) {
				const resizerBounds = entry.contentRect;
				if (entry.contentRect && bottom != null && top != null && resizerBounds != null) {
					if (resizerBounds.right <= 654) {
						body.classList.add('w-screen', 'h-screen', 'bg-red-500');
					} else if (resizerBounds?.right && resizerBounds.right > 654) {
						body.classList.remove('w-screen', 'h-screen', 'bg-red-500');
					}
				}
			}
		});

		resizeObserver.observe(resizer!);
	});
</script>
